vcpkg_from_github(
    OUT_SOURCE_PATH SOURCE_PATH
    REPO nabto/nabto-embedded-sdk
    REF "49c1e6be7810149d644cf11c48006407bb212e7d"
    SHA512 b6020cf2085fefcf3ae908251a1d5e29643499f8fe6391d5aff6445d7aa84212e20cd32e9997b11e2fe06e18561ef6d76387c34f957a20dbfae172e1739a06a2
    HEAD_REF "master"
)

vcpkg_cmake_configure(
    SOURCE_PATH "${SOURCE_PATH}"
    OPTIONS
        -DDEVICE_BUILD_EXAMPLES=FALSE
        -DDEVICE_BUILD_TESTS=FALSE
        -DDEVICE_BUILD_APPS=FALSE
        -DNABTO_DEVICE_PREFER_SYSTEM_LIB=ON
        -DNABTO_DEVICE_USE_SYSTEM_LIBEVENT=ON
        -DNABTO_DEVICE_USE_SYSTEM_NABTOCOMMON=ON
        -DNABTO_DEVICE_USE_SYSTEM_MBEDTLS=ON
        -DNABTO_DEVICE_USE_SYSTEM_NLOHMANNJSON=ON
        -DNABTO_DEVICE_USE_SYSTEM_TINYCBOR=ON
        -DNABTO_DEVICE_BUILD_WITH_VCPKG_DEPENDENCIES=TRUE
        -DNABTO_DEVICE_VERSION="0.0.0-tbd"
)

vcpkg_cmake_install()

vcpkg_copy_pdbs()

vcpkg_cmake_config_fixup(PACKAGE_NAME NabtoEmbeddedSDK CONFIG_PATH lib/cmake/NabtoEmbeddedSDK)


#vcpkg_install_copyright(FILE_LIST "${SOURCE_PATH}/LICENSING.md")
